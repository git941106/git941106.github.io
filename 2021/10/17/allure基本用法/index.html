<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="从来没有真正的绝境, 只有心灵的迷途">
    <meta name="author" content="梦">
    
    <title>
        
            allure基本用法 |
        
        梦
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/logo.svg">
    
<link rel="stylesheet" href="/css/font-awesome.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.xml"};
    KEEP.theme_config = {"toc":{"enable":false,"number":false,"expand_all":false,"init_open":false},"style":{"primary_color":"#0066CC","avatar":"/images/avatar.svg","favicon":"/images/logo.svg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":false,"background_img":"/images/bg.svg","description":"Keep writing and Keep loving."},"scroll":{"progress_bar":{"enable":false},"percent":{"enable":false}}},"local_search":{"enable":true,"preload":false},"code_copy":{"enable":false,"style":"mac"},"pjax":{"enable":false},"lazyload":{"enable":false},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"};
  </script>
<meta name="generator" content="Hexo 5.4.0"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>


<body>
<!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="progress-bar-container">
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                梦
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                分类
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">分类</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">allure基本用法</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.svg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">梦</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2021-10-17 15:41:57</span>
        <span class="mobile">2021-10-17 15:41</span>
    </span>
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/">自动化测试</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/allure/">allure</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/pytest/">pytest</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>allure是一个自动化测试中常用的插件，支持多种语言，可以生成测试报告，可以集成到jenkins中</p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><h4 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h4><ol>
<li>安装python</li>
<li>安装pytest，pip install pytest</li>
<li>安装pytest整合allure的插件，pip install allure-pytest</li>
<li>下载<a class="link"   target="_blank" rel="noopener" href="https://github.com/allure-framework/allure2/releases" >allure<i class="fas fa-external-link-alt"></i></a>，并添加到环境变量中,allure –version查看是否配置成功</li>
</ol>
<h3 id="自动化用例"><a href="#自动化用例" class="headerlink" title="自动化用例"></a>自动化用例</h3><h4 id="基础用法"><a href="#基础用法" class="headerlink" title="基础用法"></a>基础用法</h4><p>allure中的feature，story，testcase，description用法</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> logging
<span class="token keyword">import</span> allure
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support <span class="token keyword">import</span> expected_conditions
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>wait <span class="token keyword">import</span> WebDriverWait

<span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>feature</span><span class="token punctuation">(</span><span class="token string">"百度搜索-模块"</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">TestAllure</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">setup_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"初始化驱动"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://www.baidu.com/"</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">teardown_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"退出浏览器"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>story</span><span class="token punctuation">(</span><span class="token string">"百度搜索-用例标题"</span><span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>testcase</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com"</span><span class="token punctuation">,</span><span class="token string">"测试用例地址"</span><span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>issue</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com"</span><span class="token punctuation">,</span><span class="token string">"测试用例bug地址"</span><span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>description</span><span class="token punctuation">(</span><span class="token string">"这也是一个描述"</span><span class="token punctuation">)</span><span class="token comment"># </span>
    <span class="token keyword">def</span> <span class="token function">test_baidu_search</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        这是用例描述，测试百度搜索，如果没有使用@allure.description("这也是一个描述")，
        这个注释就是描述，两个是互斥的，注解的优先级高
        '''</span>
        logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"__test_allure_report__"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"allure"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">"su"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
        WebDriverWait<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>until<span class="token punctuation">(</span>expected_conditions<span class="token punctuation">.</span>title_contains<span class="token punctuation">(</span><span class="token string">"allure"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">assert</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>title <span class="token operator">==</span> <span class="token string">"allure_百度搜索"</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行用例，查看报告</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pytest --alluredir<span class="token operator">=</span>./report <span class="token comment">#指定生成json数据目录</span>
allure serve ./report<span class="token comment">#运行服务，自动打开报告网页</span>

<span class="token comment">#或者使用生成的json数据，生成静态文件</span>
allure generate path<span class="token punctuation">(</span>json数据路径<span class="token punctuation">)</span> -o path<span class="token punctuation">(</span>静态文件路径<span class="token punctuation">)</span> --clean（clean 参数会覆盖数据） 
<span class="token comment">#打开报告</span>
allure <span class="token function">open</span> -h <span class="token number">127.0</span>.0.1 -p <span class="token number">8080</span> ./report
<span class="token comment"># 生成静态文件的好处，如果重新生成静态文件，刷新会展示重新生成的数据，不用重新启动服务</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p><img src="https://random-upload.oss-cn-shenzhen.aliyuncs.com/image-20211104160305199.png" alt="代码对应效果图"></p>
<h4 id="添加用例级别"><a href="#添加用例级别" class="headerlink" title="添加用例级别"></a>添加用例级别</h4><p>运行时可以指定运行哪个级别的用例，统计每个级别的结果</p>
<p>用例级别</p>
<ol>
<li>blocker 阻塞缺陷( 程序崩溃)</li>
<li>critical 严重缺陷 （功能缺失）</li>
<li>normal 一般缺陷 （默认，边界情况，格式错误）</li>
<li>minor 次要缺陷 （界面显示问题）</li>
<li>trivial 轻微缺陷 （用户体验问题）</li>
</ol>
<p>查看allure的级别</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pytest -h <span class="token comment">#查看帮助，找到如下描述</span>
<span class="token comment">#--allure-severities=SEVERITIES_SET</span>
<span class="token comment">#                        Comma-separated list of severity names.</span>
<span class="token comment">#                        Tests only with these severities will be run.</span>
<span class="token comment">#                        Possible values are: blocker, critical, normal, minor, trivial.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>添加严重级别代码</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> allure

<span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>feature</span><span class="token punctuation">(</span><span class="token string">"百度搜索-模块"</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">TestAllure</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>severity</span><span class="token punctuation">(</span><span class="token string">"blocker"</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">test_blocker</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        1. blocker 阻塞缺陷( 程序崩溃)
        2. critical 严重缺陷 （功能缺失）
        3. normal 一般缺陷 （默认，边界情况，格式错误）
        4. minor 次要缺陷 （界面显示问题）
        5. trivial 轻微缺陷 （用户体验问题）
        :return:
        """</span>
        <span class="token keyword">assert</span> <span class="token number">1</span><span class="token operator">==</span><span class="token number">1</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>severity</span><span class="token punctuation">(</span><span class="token string">"blocker"</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">test_blocker_fail</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">assert</span> <span class="token number">1</span> <span class="token operator">==</span> <span class="token number">2</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>severity</span><span class="token punctuation">(</span><span class="token string">"critical"</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">test_critical</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">assert</span> <span class="token number">1</span><span class="token operator">==</span><span class="token number">1</span>

    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>severity</span><span class="token punctuation">(</span><span class="token string">"normal"</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">test_normal</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">assert</span> <span class="token number">1</span><span class="token operator">==</span><span class="token number">1</span>

    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>severity</span><span class="token punctuation">(</span><span class="token string">"critical"</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">test_critical_fail</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">assert</span> <span class="token number">1</span><span class="token operator">==</span><span class="token number">2</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>severity</span><span class="token punctuation">(</span><span class="token string">"normal"</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">test_normal_fail</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">assert</span> <span class="token number">1</span><span class="token operator">==</span><span class="token number">2</span>

    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>severity</span><span class="token punctuation">(</span><span class="token string">"minor"</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">test_minor</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">assert</span> <span class="token number">1</span><span class="token operator">==</span><span class="token number">1</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>severity</span><span class="token punctuation">(</span><span class="token string">"minor"</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">test_minor_fail</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">assert</span> <span class="token number">1</span><span class="token operator">==</span><span class="token number">2</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>severity</span><span class="token punctuation">(</span><span class="token string">"trivial"</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">test_trivial</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">assert</span> <span class="token number">1</span><span class="token operator">==</span><span class="token number">1</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>severity</span><span class="token punctuation">(</span><span class="token string">"trivial"</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">test_trivial_fail</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">assert</span> <span class="token number">1</span><span class="token operator">==</span><span class="token number">2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>执行用例后，查看统计结果</p>
<p><img src="https://random-upload.oss-cn-shenzhen.aliyuncs.com/image-20211104225841088.png" alt="优先级结果统计图"></p>
<p>场景：只测blocker, critical级别的用例</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pytest --alluredir<span class="token operator">=</span>./report --clean-alluredir --allure-severities<span class="token operator">=</span>blocker,critical <span class="token comment"># 多个级#别使用逗号隔开,--clean-alluredir指的是清除之前的json数据</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="添加环境配置说明信息"><a href="#添加环境配置说明信息" class="headerlink" title="添加环境配置说明信息"></a>添加环境配置说明信息</h4><p>allure报告首页，默认显示是没有环境变量，环境变量就是相关的说明，如测试人员，测试环境，版本号等相关信息</p>
<p>方法一 environment.properties文件</p>
<pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">python</span><span class="token punctuation">=</span><span class="token attr-value">3.9.0</span>
<span class="token attr-name">allure</span><span class="token punctuation">=</span><span class="token attr-value">2.13.3</span>
<span class="token attr-name">author</span><span class="token punctuation">=</span><span class="token attr-value">没有</span>
<span class="token comment"># key=value形式即可</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>方法二 environment.xml文件</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>environment</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parameter</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>key</span><span class="token punctuation">></span></span>python<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>key</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>3.9.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parameter</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parameter</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>key</span><span class="token punctuation">></span></span>allure<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>key</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>2.13.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parameter</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parameter</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>key</span><span class="token punctuation">></span></span>author<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>key</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>没有<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parameter</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>environment</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!--只需要修改key标签和value标签的值即可--></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>将其中之一的配置文件放到生成json数据的目录，然后正常运行服务，查看报告即可</p>
<p><img src="https://random-upload.oss-cn-shenzhen.aliyuncs.com/image-20211104235949317.png" alt="环境变量信息图"></p>
<h4 id="添加测试用例步骤"><a href="#添加测试用例步骤" class="headerlink" title="添加测试用例步骤"></a>添加测试用例步骤</h4><p>对于基于流程的测试用例，可以添加测试步骤说明，阅读起来更明了，例如网上购物步骤包括</p>
<p>登录-浏览商品-加入购物车-下单-支付</p>
<p>common.py</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> logging
<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"登录"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">browser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"浏览"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">shopper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"加入购物车"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"下单"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">pay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"支付"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>测试文件</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> allure
<span class="token keyword">from</span> pytest_base<span class="token punctuation">.</span>common <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>feature</span><span class="token punctuation">(</span><span class="token string">"百度搜索-模块"</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">TestAllure</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>story</span><span class="token punctuation">(</span><span class="token string">"冒烟测试"</span><span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>severity</span><span class="token punctuation">(</span><span class="token string">"blocker"</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">test_smoke_pay</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> allure<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token string">"登录"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            login<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">with</span> allure<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token string">"浏览商品"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            browser<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">with</span> allure<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token string">"加入购物车"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            shopper<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">with</span> allure<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token string">"下单"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            order<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">with</span> allure<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token string">"支付"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            pay<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">with</span> allure<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token string">"断言"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">assert</span> <span class="token number">1</span><span class="token operator">==</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>除了这种方法外，还可以在方法上加装饰器</p>
<p>common.py改为</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> logging
<span class="token keyword">import</span> allure

<span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>step</span><span class="token punctuation">(</span><span class="token string">"登录"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"登录"</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>step</span><span class="token punctuation">(</span><span class="token string">"浏览"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">browser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"浏览"</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>step</span><span class="token punctuation">(</span><span class="token string">"加入购物车"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">shopper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"加入购物车"</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>step</span><span class="token punctuation">(</span><span class="token string">"下单"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">order</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"下单"</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>step</span><span class="token punctuation">(</span><span class="token string">"支付"</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">pay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"支付"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>测试文件改为</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> allure
<span class="token keyword">from</span> pytest_base<span class="token punctuation">.</span>common <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>feature</span><span class="token punctuation">(</span><span class="token string">"百度搜索-模块"</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">TestAllure</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>story</span><span class="token punctuation">(</span><span class="token string">"冒烟测试"</span><span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>severity</span><span class="token punctuation">(</span><span class="token string">"blocker"</span><span class="token punctuation">)</span>
      <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>story</span><span class="token punctuation">(</span><span class="token string">"冒烟测试"</span><span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>severity</span><span class="token punctuation">(</span><span class="token string">"blocker"</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">test_smoke_pay</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        login<span class="token punctuation">(</span><span class="token punctuation">)</span>
        browser<span class="token punctuation">(</span><span class="token punctuation">)</span>
        shopper<span class="token punctuation">(</span><span class="token punctuation">)</span>
        order<span class="token punctuation">(</span><span class="token punctuation">)</span>
        pay<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">assert</span> <span class="token number">1</span><span class="token operator">==</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="用例描述详解"><a href="#用例描述详解" class="headerlink" title="用例描述详解"></a>用例描述详解</h4><table>
<thead>
<tr>
<th>用法</th>
<th>范围</th>
<th>参数说明</th>
</tr>
</thead>
<tbody><tr>
<td>@allure.epic()</td>
<td>测试类上</td>
<td>项目名称</td>
</tr>
<tr>
<td>@allure.feature()</td>
<td>测试类上</td>
<td>模块名称</td>
</tr>
<tr>
<td>@allure.story()</td>
<td>测试方法上</td>
<td>用户故事(场景描述)</td>
</tr>
<tr>
<td>@allure.title()</td>
<td>测试方法上</td>
<td>用例标题</td>
</tr>
<tr>
<td>@allure.testcase()</td>
<td>测试方法上</td>
<td>用例地址</td>
</tr>
<tr>
<td>@allure.issue()</td>
<td>测试方法上</td>
<td>关联bug地址</td>
</tr>
<tr>
<td>@allure.step()</td>
<td>测试方法上或方法体中</td>
<td>用例步骤</td>
</tr>
<tr>
<td>@allure.description()</td>
<td>测试方法上</td>
<td>用例描述</td>
</tr>
<tr>
<td>@allure.link()</td>
<td>测试方法上</td>
<td>其他关联地址</td>
</tr>
<tr>
<td>@allure.attach()</td>
<td>方法体中</td>
<td>报告中添加附件</td>
</tr>
</tbody></table>
<p>test_1.py</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>epic</span><span class="token punctuation">(</span><span class="token string">"epic项目"</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>feature</span><span class="token punctuation">(</span><span class="token string">"模块1"</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Test1</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>story</span><span class="token punctuation">(</span><span class="token string">"story1"</span><span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>title</span><span class="token punctuation">(</span><span class="token string">"title1"</span><span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>description</span><span class="token punctuation">(</span><span class="token string">"description1"</span><span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>issue</span><span class="token punctuation">(</span><span class="token string">"http://www.baidu.com"</span><span class="token punctuation">,</span> <span class="token string">"issue1"</span><span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>testcase</span><span class="token punctuation">(</span><span class="token string">"http://www.baidu.com"</span><span class="token punctuation">,</span> <span class="token string">"testcase1"</span><span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>link</span><span class="token punctuation">(</span><span class="token string">"http://www.baidu.com"</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"link1"</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">test_1</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> allure<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token string">"test1：step1"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"test_1"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>test_2.py</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>epic</span><span class="token punctuation">(</span><span class="token string">"epic项目"</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>feature</span><span class="token punctuation">(</span><span class="token string">"模块2"</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Test2</span><span class="token punctuation">:</span>
	<span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>story</span><span class="token punctuation">(</span><span class="token string">"story2"</span><span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>title</span><span class="token punctuation">(</span><span class="token string">"title2"</span><span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>description</span><span class="token punctuation">(</span><span class="token string">"description2"</span><span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>issue</span><span class="token punctuation">(</span><span class="token string">"http://www.baidu.com"</span><span class="token punctuation">,</span> <span class="token string">"issue2"</span><span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>testcase</span><span class="token punctuation">(</span><span class="token string">"http://www.baidu.com"</span><span class="token punctuation">,</span> <span class="token string">"testcase2"</span><span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>link</span><span class="token punctuation">(</span><span class="token string">"http://www.baidu.com"</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"link2"</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">test_2</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> allure<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token string">"test2：step1"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"test_2"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行并打开报告</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pytest -vs test_1.py test_2.py --alluredir<span class="token operator">=</span>./report --clean-alluredir <span class="token comment"># 生成json数据</span>
allure serve ./report <span class="token comment">#打开报告</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><img src="https://random-upload.oss-cn-shenzhen.aliyuncs.com/image-20211105160724012.png" alt="用例详细描述图"></p>
<p>参数命令行</p>
<p>使用pytest -h可找到如下内容</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">--allure-severities<span class="token operator">=</span>SEVERITIES_SET
                        Comma-separated list of severity names. Tests only
                        with these severities will be run. Possible values
                        are: blocker, critical, normal, minor, trivial.
--allure-epics<span class="token operator">=</span>EPICS_SET
                        Comma-separated list of epic names. Run tests that
                        have at least one of the specified feature labels.
--allure-features<span class="token operator">=</span>FEATURES_SET
                        Comma-separated list of feature names. Run tests that
                        have at least one of the specified feature labels.
--allure-stories<span class="token operator">=</span>STORIES_SET
                        Comma-separated list of story names. Run tests that
                        have at least one of the specified story labels.
--allure-link-pattern<span class="token operator">=</span>LINK_TYPE:LINK_PATTERN
                        Url pattern <span class="token keyword">for</span> <span class="token function">link</span> type. Allows short links <span class="token keyword">in</span> test,
                        like <span class="token string">'issue-1'</span><span class="token builtin class-name">.</span> Text will be formatted to full url
                        with python str.format<span class="token punctuation">(</span><span class="token punctuation">)</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>只运行指定的story</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pytest -vs test_1.py test_2.py --allure-stories<span class="token operator">=</span><span class="token string">"story1,story2"</span> --alluredir<span class="token operator">=</span>./report --clean-alluredir 
<span class="token comment">#运行@allure.story("story2")或者@allure.story("story1")的测试方法，多个story用逗号隔开</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="报告中添加附件"><a href="#报告中添加附件" class="headerlink" title="报告中添加附件"></a>报告中添加附件</h4><p>allure支持在报告中添加文本，html，图片，文件，视频</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> logging
<span class="token keyword">import</span> os

<span class="token keyword">import</span> allure
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support <span class="token keyword">import</span> expected_conditions
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>wait <span class="token keyword">import</span> WebDriverWait

<span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>feature</span><span class="token punctuation">(</span><span class="token string">"模块"</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">TestAllureAttach</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">setup_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"初始化驱动"</span><span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://www.baidu.com/"</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">teardown_class</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
         logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"退出浏览器"</span><span class="token punctuation">)</span>
         self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>story</span><span class="token punctuation">(</span><span class="token string">"百度搜索-用例标题"</span><span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>testcase</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com"</span><span class="token punctuation">,</span> <span class="token string">"测试用例地址"</span><span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>issue</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com"</span><span class="token punctuation">,</span> <span class="token string">"测试用例bug地址"</span><span class="token punctuation">)</span>
    <span class="token decorator annotation punctuation">@allure<span class="token punctuation">.</span>description</span><span class="token punctuation">(</span><span class="token string">"这也是一个描述"</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">test_baidu_search</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        这是用例描述，测试百度搜索
        '''</span>
        logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"__test_allure_report__"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"allure"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">"su"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
        WebDriverWait<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>until<span class="token punctuation">(</span>expected_conditions<span class="token punctuation">.</span>title_contains<span class="token punctuation">(</span><span class="token string">"allure"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">with</span> allure<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token string">"添加文件"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>realpath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span>
            allure<span class="token punctuation">.</span>attach<span class="token punctuation">.</span><span class="token builtin">file</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>path<span class="token punctuation">,</span><span class="token string">"pytest.ini"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"pytest.ini"</span><span class="token punctuation">,</span>allure<span class="token punctuation">.</span>attachment_type<span class="token punctuation">.</span>TEXT<span class="token punctuation">)</span>
        <span class="token keyword">with</span> allure<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token string">"添加网页"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            allure<span class="token punctuation">.</span>attach<span class="token punctuation">(</span><span class="token string">"&lt;h2>这是网页内容&lt;/h2>"</span><span class="token punctuation">,</span><span class="token string">"添加网页"</span><span class="token punctuation">,</span>allure<span class="token punctuation">.</span>attachment_type<span class="token punctuation">.</span>HTML<span class="token punctuation">)</span>
        <span class="token keyword">with</span> allure<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token string">"添加文本"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            allure<span class="token punctuation">.</span>attach<span class="token punctuation">(</span><span class="token string">"这是文本内容"</span><span class="token punctuation">,</span><span class="token string">"添加文本"</span><span class="token punctuation">,</span>allure<span class="token punctuation">.</span>attachment_type<span class="token punctuation">.</span>TEXT<span class="token punctuation">)</span>
        <span class="token keyword">with</span> allure<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token string">"添加截图"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            allure<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>get_screenshot_as_png<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"添加截图"</span><span class="token punctuation">,</span>allure<span class="token punctuation">.</span>attachment_type<span class="token punctuation">.</span>PNG<span class="token punctuation">)</span>
        <span class="token keyword">with</span> allure<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token string">"断言"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">assert</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>title <span class="token operator">==</span> <span class="token string">"allure_百度搜索"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://random-upload.oss-cn-shenzhen.aliyuncs.com/image-20211105174953269.png" alt="添加附件截图"></p>
<h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><blockquote>
<p><a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/yoyoketang/tag/pytest/default.html?page=4" >https://www.cnblogs.com/yoyoketang/tag/pytest/default.html?page=4<i class="fas fa-external-link-alt"></i></a></p>
</blockquote>

        </div>

        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/allure/">#allure</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/tags/pytest/">#pytest</a>&nbsp;
                    </li>
                
            </ul>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2021/10/20/%E6%B6%88%E6%81%AF%E6%8E%A8%E9%80%81/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">消息推送</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2021/10/16/linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">linux常用命令</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>
              -
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">梦</a>
        </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="fas fa-arrow-up"></i>
            </li>
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
    </ul>
</div>

    </div>

    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>



    
<script src="/js/local-search.js"></script>







<div class="post-scripts">
    
</div><!-- hexo-inject:begin --><!-- hexo-inject:end -->



</body>
</html>
